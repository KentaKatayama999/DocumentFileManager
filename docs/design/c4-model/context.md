# System Context図: Document File Manager

## 概要

Document File Managerシステムの全体像を示すContext図（C4モデル レベル1）です。システムの外部境界、ユーザー、外部システムとの関係を可視化します。

- **対象読者**: ステークホルダー、プロジェクトマネージャー、アーキテクト
- **目的**: システムの責務範囲と外部連携を理解する

## 構成要素

### System: Document File Manager

- **種別**: ソフトウェアシステム
- **技術スタック**: .NET 9.0 / .NET 8.0, WPF, SQLite
- **責務**:
  - 技術資料（PDF, Office, CAD等）とチェックリストを統合管理
  - チェック項目と資料の紐づけ管理
  - 画面キャプチャ機能による作業エビデンス保存
  - 進捗可視化（最新リンク判定、紐づけ表示）
- **判断根拠**:
  - README.mdに記載された主な機能
  - プロジェクト固有のデータ管理（workspace.db, captures/）

### Person: エンドユーザー

- **役割**: 資料管理者、チェック作業者
- **責務**:
  - 資料ファイルの登録・閲覧
  - チェックリストの操作（チェックON/OFF）
  - 進捗確認
  - 外部アプリケーションを使った資料の閲覧・編集
- **判断根拠**:
  - docs/ユースケース.mdに記載された利用シナリオ
  - 認証機能なし（ローカルデスクトップアプリ）

### System_Ext: 外部アプリケーション

- **例**: Microsoft Office (Word, Excel), CAD (AutoCAD, SolidWorks), PDF Viewer, メールクライアント
- **役割**:
  - 実際の資料ファイルの閲覧・編集を担当
  - Document File Managerから起動される
  - 画面キャプチャの対象となる
- **判断根拠**:
  - DocumentFileManager.Viewerが外部プログラム連携機能を持つ（README.md L162-163）
  - ScreenCaptureServiceの実装（画面キャプチャ機能）
  - プロセス起動コード（Process.Start）の存在

### System_Ext: ファイルシステム

- **技術**: NTFS / FAT32
- **役割**:
  - 実際の資料ファイル（PDF, DOCX等）の保存
  - キャプチャ画像（captures/）の保存
  - チェックリスト定義（checklist.json）の保存
  - アプリケーション設定（appsettings.json）の保存
- **判断根拠**:
  - README.md L36-48のプロジェクトフォルダ構成
  - PathSettings.csの設定項目

## 関連・依存関係

### Rel: エンドユーザー → Document File Manager

- **内容**: 資料登録、チェックリスト操作、進捗確認
- **プロトコル/方法**: WPF UI
- **理由**: WPFデスクトップアプリケーションとして実装されている

### Rel: エンドユーザー → 外部アプリケーション

- **内容**: 資料の閲覧・編集
- **プロトコル/方法**: 直接操作
- **理由**: ユーザーは外部アプリを直接操作して資料を編集する

### Rel: Document File Manager → 外部アプリケーション

- **内容**: ファイルを開く、ウィンドウ制御
- **プロトコル/方法**: Process.Start, Win32 API
- **理由**:
  - DocumentFileManager.Viewerが外部プログラムを起動（README.md L162-163）
  - Win32 APIでウィンドウハンドル取得・位置制御（README.md L168-169）

### Rel: Document File Manager → 外部アプリケーション (画面キャプチャ)

- **内容**: 画面キャプチャ取得
- **プロトコル/方法**: Win32 API / Screen Capture
- **理由**:
  - ScreenCaptureServiceの実装
  - チェック項目と画面キャプチャの紐づけ機能（README.md L21）

### Rel: Document File Manager → ファイルシステム

- **内容**: ファイル読み書き
- **プロトコル/方法**: File I/O
- **理由**:
  - 資料ファイルの読み込み
  - キャプチャ画像の保存
  - checklist.jsonの読み書き
  - appsettings.jsonの読み込み

## 設計判断

### デスクトップアプリケーションとしての選択

- **決定**: WPFデスクトップアプリケーションとして実装
- **理由**:
  - ローカルファイル操作が主体
  - 画面キャプチャ機能が必須（Win32 API利用）
  - オフラインでの利用が前提
- **トレードオフ**:
  - 利点: 高速なファイルアクセス、Win32 API利用可能
  - 欠点: クロスプラットフォーム非対応（Windows専用）

### 外部アプリケーション連携

- **決定**: 外部アプリケーションを直接起動・制御
- **理由**:
  - 様々なファイル形式に対応（Office, CAD, PDF等）
  - 専用アプリケーションの機能をそのまま利用
  - Document Viewer（内部ビューア）と組み合わせて使い分け
- **トレードオフ**:
  - 利点: 豊富なファイル形式サポート、専門的な編集機能
  - 欠点: 外部アプリのインストールが必要、ウィンドウ制御の複雑さ

### プロジェクト固有データ管理

- **決定**: プロジェクトフォルダ内にすべてのデータを配置
- **理由**:
  - プロジェクトの可搬性確保
  - バージョン管理の容易さ
  - 複数プロジェクトの独立管理
- **トレードオフ**:
  - 利点: データの一元管理、バックアップ容易
  - 欠点: 大規模ファイルの場合、フォルダサイズが大きくなる

## 凡例

- **Person** (青): システムを利用する人間
- **System** (青): 対象システム（Document File Manager）
- **System_Ext** (グレー): 外部システム
- **Rel** (矢印): システム間の関連・依存関係

## 関連ドキュメント

- **PlantUML図**: [context.puml](./context.puml)
- **下位レベル図**: [container.md](./container.md) - コンテナ図（レベル2）
- **要件定義**: [../../docs/要件定義.md](../../要件定義.md)
- **ユースケース**: [../../docs/ユースケース.md](../../ユースケース.md)
